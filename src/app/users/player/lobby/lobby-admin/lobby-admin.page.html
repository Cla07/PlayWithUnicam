<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Lobby di gioco</ion-title>

    <ion-button slot="end" (click)="abbandonaLobby()" fill="clear" color="light" shape="round" class="ion-hide-md-down">
      <ion-label>Abbandona lobby</ion-label>
      <ion-icon slot="start" name="exit-outline"></ion-icon>
    </ion-button>

    <ion-button slot="end" (click)="abbandonaLobby()" fill="clear" shape="round" class="ion-hide-md-up"
      style="color: #fff;">
      <ion-icon slot="icon-only" name="exit-outline"></ion-icon>
    </ion-button>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-grid fixed>
    <ion-row>
      <ion-col size="12">
        <ion-card-header>
          <ion-card-subtitle style="text-align: center;">Codice Lobby</ion-card-subtitle>
          <ion-card-title style="font-size: 25px; font-weight:bold; text-align: center;">{{lobby.codice}}
          </ion-card-title>
        </ion-card-header>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col size-lg="3.5" size-md="12" size-sm="12" size="12">
        <ion-card id="normal-info-card" class="info-card">
          <ion-list>
            <ion-list-header>
              <ion-title>INFO LOBBY</ion-title>
            </ion-list-header>

            <ion-item>
              <ion-col size="7">
                <ion-label>Partecipanti</ion-label>
              </ion-col>
              <ion-col size="2.5">
                <ion-label style="text-align: center;">
                  <p>MIN</p>
                  <h2>{{lobby.min_giocatori}}</h2>
                </ion-label>
              </ion-col>

              <ion-col size="2.5">
                <ion-label style="text-align: center;">
                  <p>MAX</p>
                  <h2>{{lobby.max_giocatori}}</h2>
                </ion-label>
              </ion-col>
            </ion-item>

            <ion-item lines="none">
              <ion-col>
                <ion-label>Visibilità pubblica</ion-label>
              </ion-col>
              <ion-toggle slot="end" [(ngModel)]="lobby.pubblica"></ion-toggle>
            </ion-item>

            <ion-card-content style="padding: 20px;">
              <p>Se attivo, permette a tutti i giocatori online di trovare la lobby e di parteciparvi.</p>
              <br>
              <ion-button shape="round" (click)="modificaLobby()" expand="block">Salva modifiche</ion-button>
            </ion-card-content>
          </ion-list>
        </ion-card>

        <ion-card id="expandable-info-card" class="info-card" button="true" (click)="espandiInfoLobby()">
          <ion-list>
            <ion-item lines="none">
              <ion-title style="text-align: left !important;">INFO LOBBY</ion-title>
              <ion-icon slot="end" name="chevron-forward-circle-outline" *ngIf="!mostraInfoLobby"></ion-icon>
              <ion-icon slot="end" name="chevron-down-circle-outline" *ngIf="mostraInfoLobby"></ion-icon>
            </ion-item>

            <ion-item *ngIf="mostraInfoLobby">
              <ion-col size="7">
                <ion-label>Partecipanti</ion-label>
              </ion-col>
              <ion-col size="2.5">
                <ion-label style="text-align: center;">
                  <p>MIN</p>
                  <h2>{{lobby.min_giocatori}}</h2>
                </ion-label>
              </ion-col>

              <ion-col size="2.5">
                <ion-label style="text-align: center;">
                  <p>MAX</p>
                  <h2>{{lobby.max_giocatori}}</h2>
                </ion-label>
              </ion-col>
            </ion-item>

            <ion-item lines="none" *ngIf="mostraInfoLobby">
              <ion-col>
                <ion-label>Visibilità pubblica</ion-label>
              </ion-col>
              <ion-toggle slot="end" [(ngModel)]="lobby.pubblica"></ion-toggle>
            </ion-item>

            <ion-card-content style="padding: 20px;" *ngIf="mostraInfoLobby">
              <p>Se attivo, permette a tutti i giocatori online di trovare la lobby e di parteciparvi.</p>

              <br>
              <ion-button shape="round" (click)="modificaLobby()" expand="block">Salva modifiche</ion-button>
            </ion-card-content>
          </ion-list>
        </ion-card>
      </ion-col>

      <ion-col size-lg="4.5" size-md="12" size-sm="12" size="12">
        <ion-card id="normal-players-card" class="players-card">
          <ion-list>
            <ion-list-header>
              <ion-title>PARTECIPANTI</ion-title>
            </ion-list-header>

            <ion-item lines="full" *ngFor="let giocatore of giocatori, let i = index;"
              [ngClass]="{'admin' : giocatore.username == lobby.admin_lobby}">
              <ion-avatar slot="start">
                <img src="../../../../../assets/icon/lobby-player.png" alt="Giocatore {{ giocatore.username }}">
              </ion-avatar>

              <ion-label>{{ giocatore.username }}</ion-label>
              <p slot="end" *ngIf="giocatore.username == lobby.admin_lobby" class="admin-label">ADMIN</p>
              <ion-icon slot="end" name="diamond-outline" *ngIf="giocatore.username == lobby.admin_lobby"></ion-icon>
              <ion-icon slot="end" name="trash-outline" tappable (click)="eliminaPartecipante(giocatore.username, i)"
                *ngIf="giocatore.username != lobby.admin_lobby"></ion-icon>
            </ion-item>
          </ion-list>
        </ion-card>

        <ion-card id="slide-players-card" class="players-card">
          <ion-list>
            <ion-list-header>
              <ion-title>PARTECIPANTI</ion-title>
            </ion-list-header>

            <ion-slides [options]="{ slidesPerView: 'auto', zoom: false, grabCursor: true }" style="padding:15px;">
              <ion-slide *ngFor="let giocatore of giocatori, let i = index;"
                style="width: 100px; height: 150px; border-radius: 20px;"
                [ngClass]="{'admin' : giocatore.username == lobby.admin_lobby}">
                <ion-col style="align-items: center;">
                  <ion-label>{{ giocatore.username }}</ion-label>
                  <ion-avatar style="margin: auto;">
                    <img src="../../../../../assets/icon/lobby-player.png" alt="Giocatore {{ giocatore.username }}">
                  </ion-avatar>
                  <br>
                  <p *ngIf="giocatore.username == lobby.admin_lobby" class="admin-label"
                    style="position:absolute; margin-top: -18px; margin-left: 23px; z-index: 1;">ADMIN</p>
                  <ion-icon size="large" name="diamond-outline" *ngIf="giocatore.username == lobby.admin_lobby">
                  </ion-icon>
                  <ion-icon size="large" name="trash-outline" tappable
                    (click)="eliminaPartecipante(giocatore.username, i)"
                    *ngIf="giocatore.username != lobby.admin_lobby"></ion-icon>
                </ion-col>
              </ion-slide>
            </ion-slides>
          </ion-list>
        </ion-card>

        <ion-button expand="block" shape="round" (click)="iniziaPartita()" class="start-button-row">INIZIA PARTITA!
        </ion-button>
      </ion-col>

      <ion-col size-lg="4" size-md="12" size-sm="12" size="12">
        <ion-card id="normal-game-card" class="game-card">
          <ion-list>
            <ion-list-header>
              <ion-title>INFO GIOCO</ion-title>
            </ion-list-header>

            <ion-card-header>
              <ion-card-subtitle style="text-align: center; color:rgb(16, 64, 85);">Nome</ion-card-subtitle>
              <ion-card-title style="font-size: 22px; font-weight:bold; text-align: center;">{{ lobby.nome }}
              </ion-card-title>
            </ion-card-header>

            <ion-card-content>
              <h2 *ngIf="lobby.regolamento">Regolamento</h2>
              <ion-card-subtitle *ngIf="lobby.regolamento" style="color:rgb(16, 64, 85);">{{ lobby.regolamento }}
              </ion-card-subtitle>
            </ion-card-content>
          </ion-list>
        </ion-card>

        <ion-card id="expandable-game-card" class="game-card" button="true" (click)="espandiInfoGioco()">
          <ion-list>
            <ion-item lines="none">
              <ion-title style="text-align: left !important;">INFO GIOCO</ion-title>
              <ion-icon slot="end" name="chevron-forward-circle-outline" *ngIf="!mostraInfoGioco"></ion-icon>
              <ion-icon slot="end" name="chevron-down-circle-outline" *ngIf="mostraInfoGioco"></ion-icon>
            </ion-item>

            <ion-card-header *ngIf="mostraInfoGioco">
              <ion-card-subtitle style="text-align: center; color:rgb(16, 64, 85);">Nome</ion-card-subtitle>
              <ion-card-title style="font-size: 22px; font-weight:bold; text-align: center;">{{ lobby.nome }}
              </ion-card-title>
            </ion-card-header>

            <ion-card-content *ngIf="mostraInfoGioco">
              <h2 *ngIf="lobby.regolamento">Regolamento</h2>
              <ion-card-subtitle *ngIf="lobby.regolamento" style="color:rgb(16, 64, 85);">{{ lobby.regolamento }}
              </ion-card-subtitle>
            </ion-card-content>
          </ion-list>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>

</ion-content>

<ion-footer class="start-button-footer">
  <ion-toolbar color="primary">
    <ion-button fill="clear" color="light" expand="full" (click)="iniziaPartita()">INIZIA PARTITA!</ion-button>
  </ion-toolbar>
</ion-footer>